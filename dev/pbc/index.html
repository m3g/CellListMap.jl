<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Periodic conditions · CellListMap.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="CellListMap.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="CellListMap.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CellListMap.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Periodic conditions</a><ul class="internal"><li><a class="tocitem" href="#Orthorhombic-periodic-boundary-conditions"><span>Orthorhombic periodic boundary conditions</span></a></li><li><a class="tocitem" href="#Triclinic-periodic-boundary-conditions"><span>Triclinic periodic boundary conditions</span></a></li><li><a class="tocitem" href="#Without-periodic-boundary-conditions"><span>Without periodic boundary conditions</span></a></li></ul></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../units_etc/">Units, autodiff, etc.</a></li><li><a class="tocitem" href="../performance/">Performance</a></li><li><a class="tocitem" href="../options/">Options</a></li><li><a class="tocitem" href="../python/">From Python</a></li><li><a class="tocitem" href="../help/">Help entries</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Periodic conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Periodic conditions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/CellListMap.jl/blob/master/docs/src/pbc.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Periodic-boundary-conditions">Periodic boundary conditions</a><a id="Periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-boundary-conditions" title="Permalink"></a></h1><h2 id="Orthorhombic-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Orthorhombic-periodic-boundary-conditions">Orthorhombic periodic boundary conditions</a><a id="Orthorhombic-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Orthorhombic-periodic-boundary-conditions" title="Permalink"></a></h2><p>Orthorhombic periodic boundary conditions allow some special methods that are faster than those for general cells. To initialize an Orthorhombic cell, just provide the length of the cell on each side, and the cutoff. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; box = Box([100,70,130],12)
Box{OrthorhombicCell, 3, Float64, 9}
  unit cell matrix: [100.0 0.0 0.0; 0.0 70.0 0.0; 0.0 0.0 130.0]
  cutoff: 12.0
  number of computing cells on each dimension: [10, 7, 12]
  computing cell sizes: [12.5, 14.0, 13.0] (lcell: 1)
  Total number of cells: 840</code></pre><h2 id="Triclinic-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Triclinic-periodic-boundary-conditions">Triclinic periodic boundary conditions</a><a id="Triclinic-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Triclinic-periodic-boundary-conditions" title="Permalink"></a></h2><p>Triclinic periodic boundary conditions of any kind can be used. However, the input has some limitations for the moment. The lattice vectors must have strictly positive coordinates, and the smallest distance within the cell cannot be smaller than twice the size of the cutoff. An error will be produced if the cell does not satisfy these conditions. </p><p>Let us illustrate building a two-dimensional cell, for easier visualization. A matrix of column-wise lattice vectors is provided in the construction of the box, and that is all. </p><p>Here, the lattice vectors are <code>[1,0]</code> and <code>[0.5,1]</code> (and we illustrate with <code>cutoff=0.1</code>): </p><pre><code class="language-julia-repl hljs">julia&gt; box = Box([ 1.0  0.5
                     0  1.0 ], 0.1);

julia&gt; x = 10*rand(SVector{2,Float64},1000);</code></pre><p>We have created random coordinates for <code>1000</code> particles, that are not necessarily wrapped according to the periodic boundary conditions. We can see the coordinates in the minimum image cell with:</p><pre><code class="language-julia-repl hljs">julia&gt; using Plots

julia&gt; CellListMap.draw_computing_cell(x,box)</code></pre><img src=https://raw.githubusercontent.com/m3g/CellListMap.jl/main/docs/src/assets/lattice.png><p>The construction of the cell list is, as always, done with:</p><pre><code class="language-julia-repl hljs">julia&gt; cl = CellList(x,box)
CellList{2, Float64}
  109 cells with real particles.
  2041 particles in computing box, including images.
</code></pre><p>Upon construction of the cell lists, the particles are replicated to fill a rectangular box (or orthorhombic box, in three-dimensions), with boundaries that exceed the actual system size. This improves the performance of the pairwise computations by avoiding the necessity of wrapping coordinates on the main loop (this is an implementation detail only). </p><p>In summary, to use arbitrary periodic boundary conditions, just initialize the box with the matrix of lattice vectors. In three dimensions, for example, one could use:</p><pre><code class="language-julia-repl hljs">julia&gt; box = Box([ 50.  0. 00. 
                    0. 30. 30.          
                    0. 00. 50. ],  2.)

julia&gt; x = 100*rand(SVector{3,Float64},10000);

julia&gt; p = [ CellListMap.wrap_to_first(x,box) for x in x ];

julia&gt; using Plots

julia&gt; scatter(Tuple.(p),aspect_ratio=1,framestyle=:box,label=:none)</code></pre><p>to work with an arbitrary 3D lattice, Which in this case looks like:</p><img src=https://raw.githubusercontent.com/m3g/CellListMap.jl/main/docs/src/assets/3Dlattice.png><h2 id="Without-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Without-periodic-boundary-conditions">Without periodic boundary conditions</a><a id="Without-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Without-periodic-boundary-conditions" title="Permalink"></a></h2><p>To avoid the use of periodic boundary conditions it is enough to define an Orthorhombic box with lengths in each direction that are larger than the limits of the coordinates of the particles plus the cutoff. This can be done automatically with the <code>limits</code> function. The box must be constructed with:</p><pre><code class="language-julia-repl hljs">julia&gt; x = [ [100,100,100] .* rand(3) for i in 1:100_000 ];

julia&gt; box = Box(limits(x),12)
Box{OrthorhombicCell, 3, Float64, 9}
  unit cell matrix: [111.99749159163106 0.0 0.0; 0.0 111.99757156637344 0.0; 0.0 0.0 111.99910298572958]
  cutoff: 12.0
  number of computing cells on each dimension: [11, 11, 11]
  computing cell sizes: [12.444165732403452, 12.444174618485938, 12.444344776192175] (lcell: 1)
  Total number of cells: 1331</code></pre><p>or, for computing the interaction between two disjoint sets of particles, call the <code>limits</code> function with two arguments:</p><pre><code class="language-julia-repl hljs">julia&gt; x = [ [100,100,100] .* rand(3) for i in 1:100_000 ];

julia&gt; y = [ [120,180,100] .* rand(3) for i in 1:100_000 ];

julia&gt; box = Box(limits(x,y),12)
Box{OrthorhombicCell, 3, Float64, 9}
  unit cell matrix: [131.9978650409108 0.0 0.0; 0.0 191.99730748624336 0.0; 0.0 0.0 111.99917288242698]
  cutoff: 12.0
  number of computing cells on each dimension: [12, 17, 11]
  computing cell sizes: [13.19978650409108, 12.799820499082891, 12.444352542491886] (lcell: 1)
  Total number of cells: 2244</code></pre><p>Note that the unit cell length is, on each direction, the maximum coordinates of all particles plus the cutoff. This will avoid the computation of pairs of periodic images. The algorithms used for computing interactions in Orthorhombic cells will then be used.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><a class="docs-footer-nextpage" href="../parallelization/">Parallelization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.14 on <span class="colophon-date" title="Tuesday 15 March 2022 19:03">Tuesday 15 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
